## 滑动窗口刷题总结
### (一)固定窗口
#### 字符串的排序 q567
#### 方法一：固定窗口+哈希表
- ==重点：==
  1. ==缩小窗口的条件是right-left超过固定窗口大小(s1.length)==
  2. ==返回true的条件是窗口内元素为s1的任意序列(valid=need.size)==
- ==题解：==
  1. 初始化窗口指针、使用哈希表need记录目标s1各字符出现的频率、初始化窗口哈希表window、窗口字符符合条件计数值valid
  2. ==滑动窗口规则：先判定窗口是否满足条件，再判定是否要缩小窗口==
    1. ==扩展窗口right++，当频率相等时，valid++==
    2. ==判定valid是否等于need.size()，是说明该窗口即满足条件，返回true==
    3. ==判断窗口大小是否大于s1.length()。是则缩小窗口left++，当缩小前频率相等时，valid--再缩小==
  3. 到此说明不满足返回false

#### 串联所有单词的子串 q30
- ==失败尝试==：不能再滑动窗口内动态的截取单词，会出现==单词与单词直接公用了字符的情况，出现耦合==
  - 如aba或abaa，["ab","ba"]。
    - 动态截取如[a[b]a]，中间的b被使用了两次
- 失败教训：限定了单词之间分离的情况，那么需将单词作为整体

#### 方法一：固定窗口+哈希表
- ==【同q567】，但以单词为最小单位==
- ==题解：==
  1. ==初始化窗口总长度winSize为words数组总厂*单个word长度、按频率哈希表need、窗口字符符合条件计数值valid==
  2. ==遍历words数组，记录频率于need哈希表==
  3. ==遍历s，以每个字符作为窗口起点，匹配[i,winSize]单词频率是否等于need单词频率==
    - 【此步骤同q567】

#### 找到字符串中所有字母异位词 q438
- ==【同q567】，但需要将结果保存到List==

### (二)满足条件最小窗口
#### 最小覆盖子串 q76
- ==注意点：==
  - ==包装类作为一个对象需使用equal比较相等而不能用"=="==
- ==题解：==
  1. ==初始化最小窗口resL/resR、初始化intMap容器window和need、初始化窗口指针、满足窗口字符符合条件计数值valid和target==
  2. ==滑动窗口，使得窗口内存在满足条件，但不一定是最小窗口==
  3. ==循环判断窗口是否满足最小覆盖子串==
    1. ==保存满足条件窗口的左右指针==
    2. ==不断缩小窗口，直到不满足最小覆盖子串==
  4. 返回最小窗口
- 方案：
  - 可变窗口：
  1. 初始化：窗口指针、窗口容器、窗口字符符合条件计数值、满足条件的对照容器、满足条件的子串的始终位置
  2. 填充满足条件的对照容器Map need
  3. 滑动窗口，当满足条件时，即valid==need.size，保存子串的start和end位置

#### 长度最小的子数组 q209
- ==重点：缩小窗口的条件为窗口内元素之和大于target==
- ==题解：==
  1. ==初始化左右指针、sum为0、保存结果长度res为MAX_VALUE==
  2. ==滑动窗口==
    1. ==sum累加元素值==
    2. ==遍历当sum>=target，保存最小长度，缩小窗口==
  3. ==返回最小长度==
- 方案：
  - 滑动窗口
  1. 初始化窗口指针、当前窗口元素之和、当前最小连续子数组长度res
  2. 滑动窗口
  3. 当当前窗口元素之和大于等于target
    1. 实时保存最小len至res
    2. 缩小窗口
  4. 滑动窗口结束，返回res

### (三)、满足条件最大窗口
#### 无重复字符吃的最长子串 q3
- ==重点：缩小窗口的条件为存在重复字符==
- ==题解：==
  1. ==初始化窗口指针、初始化Set作窗口容器window、最长子串res=0==
  2. 滑动窗口
    1. ==字符不存在于window，保存最长子串长度，并添加进window==
    2. ==字符存在于窗口，不断缩小窗口，直到left等于重复字符的右边为止==
  3. 返回res
- 方案：
  - 可变窗口：
  1. 初始化窗口指针、窗口容器window、长度记录
  2. 滑动窗口
  3. 当window[字符]>1时(存在重复)缩小窗口
  4. 保存当前最长子串长度Math.max(res,right-left)

#### 最大连续1的个数3 q1004
- ==题解：==
  1. ==初始化窗口指针、结果res、窗口的'0'累加zeroSum==
  2. ==滑动窗口==
    1. ==当元素为1时，保存最大连续1个个数==
    2. ==当元素为0时，判断zeroSum是否大于k==
      1. ==不大于k，保存最大连续1个数，zeroSum累加，right++右扩指针==
      2. ==大于等于k，找到当前窗口最左边的0，将left设为该0的右边，zeroSum减一==
  3. 返回res

#### 最长湍流子数组 q978
- 提示：湍流子数组即驼峰或山谷：

![image](http://note.youdao.com/yws/res/32749/4572CE99AA8F4CD691A5302EFD5B2023)
- 重点：
  1. ==当A元素超过3个时，如中间的数为驼峰或谷底时，则湍流子子数组为3==
  2. ==当A元素小于3个时，也算湍流子：==
    - A.length=1==>1
    - A.length=2==>相等则1，不相等则2
- 题解：
  1. ==初始化res，当元素数量>=2时，判定前两个元素不相等则res初始化为2，否则初始化为1==
  2. 初始化窗口指针
  3. 滑动窗口
    1. ==套用题目公式，是则保存最长湍流子数组长度，即max(res,right-left+2)==
    2. ==否则重设起点left=right==
- 方案：
  - 滑动窗口
  1. 初始化窗口指针、满足条件窗口长度res
  2. 先处理前两个元素
    - A.length=1，则res=1
    - A.length>=2，且A[0]=A[1]则res=1，反之res=2
  3. 滑动窗口right<A.length-2
  4. right++
  5. 判断right-1,right,right+1是否符合驼峰或谷底
    1. 符合则保存最长至res=right-left+2(+2是第一个驼峰或谷底由3个元素组成)
    2. 不符合则重新计算湍流子left=right
       6.滑动窗口结束，返回res

#### 水果成篮 q904
- ==注意：必须使用【哈希表】记录水果型号出现的次数，而不能使用Set。==
  - 因为存在[1,0,1,4,1,4]这种情况，相互穿插
- ==重点：缩小窗口条件为水果型号超过2种==
- ==题解：==
  1. 初始化窗口指针、哈希表valid、res
  2. ==valid.size() > 2则缩小窗口==
  3. ==保存水果总数res=Max(res,right-left)==
  4. 返回res

### (四)普通可变窗口
#### 统计优美子数组 q1248
#### 方法一：可变窗口
- ==重点：优美子数组受左右偶数数量影响组合次数==
- ==题解：==
  1. ==滑动窗口，直到恰好k个奇数==
  2. ==恰好k个奇数==
    1. 统计窗口左边偶数数量
    2. 统计窗口右边偶数数量
    3. ==res+=(左偶+1)*(右偶+1)==
    4. ==left右缩使得不满足k个奇数条件，继续统计==
  3. 返回res

#### 方法二：可变窗口+思路
- 复杂度：2*方法一
- 【思路同q992】
- ==恰好k题解：恰好(等于)K=最多K-最多K-1==
- ==最多k题解：==
  - ==同q992，不过换成计算个数==

#### 方法三：前缀和
- 略

#### 性能：前缀和>方法一>方法二

#### k个不同整数的子数组 q992
- ==为什么不选择一遍遍历，即“恰好k”？==
  - ==因为整数可能分布在不同的位置，较难控制窗口左右边界==
  - 但比如q1248的优美子数组，判定条件是元素是否为奇数，此条件只涉及到一个元素，一遍“O(N)”更佳

#### 方法一：滑动窗口+思路转换
- ==恰好k题解：恰好(等于)K=最多K-最多K-1==
- ==最多k题解：==
  - 规律是1+2+3+4...，即组合的子数组个数
  1. ==右扩窗口，window只要不大于k，res+=right-left==
  2. ==当window>k时，左缩窗口，直到不大于k==
  3. 返回res

#### 替换后的最长重复字符q424
- ==题解：==
  1. 初始化窗口指针、当前最大频率字符数量maxFreq、统计窗口内字符频率window
  2. ==滑动窗口，动态记录最大频率的字符maxFreq，更新window==
  3. ==当窗口内字符数量>maxFreq+k时缩小窗口==
  4. ==保存max(res,窗口内字符数量)，即最长重复字符==

#### 至少有K个重复字符的最长子串 q395
#### 方法一：滑动窗口
- ==思路-简答版：遍历窗口存在1-26种字符的情况，以次参数作为缩小窗口依据，如边界情况：==
  - ==遍历1种字符的情况，至少取得最少字符的最长子串==
  - ==遍历26种字符的情况，贪心的取得最长的情况，即字符相互交叉的情况==
- 思路-解释版：统计窗口内小于k的字符数量，为0时，说明窗口满足条件，保存结果
  - 存在问题：什么时候缩小窗口？
  - 情况1：abcabcd,k=2，此时不缩小窗口即可获得答案
  - 情况2：abbbcdabcd,k=3，此时必须在bbb的时候缩小窗口，才可获取答案bbb
  - 解决问题，假如窗口内存在1-26种字母的情况，即遍历1-26种情况：
  - 针对情况1：
    1. 窗口字母种类为1。res=0
    2. 窗口字母种类为2。res=0
    3. 窗口字母种类为3。res=6
    4. ...
  - 针对情况2：
    1. 窗口字母种类为1。res=3
    2. 窗口字母种类为2。res=0
    3. 窗口字母种类为...。res=0
- ==题解：==
  1. ==遍历1-26遍历为t，代表窗口内最多的字符种类==
  2. ==以t为缩小窗口的依据，初始化window容器存放字母频率、统计窗口字符种类type、窗口字符小于k的less==
  3. ==滑动窗口==
    1. ==当窗口种类type>t时，缩小窗口==
    2. ==当less=0时，保存最长子串至res==
  4. 返回res

#### 方法二：分治
- ==思路：统计字符频率，将<k的字符作为中间值，分割左右子串，递归统计左右子串是否满足条件==
- 题解：略，看分治刷题笔记

#### 爱生气的书店老板 q1052
- ==思路：先累加计算原本就满意的客户，并置为0，再以X作为窗口大小，找到可能不满意客户的窗口最大值。相加即为最大客户数。==
- ==题解：==
  1. ==先计算原本就满意的客户。累加计算一定满意客户为satisfied，设customers[i]为0==
  2. ==再滑动固定x长度的窗口，找到窗口元素和最大的值==
  3. ==返回原本满意+窗口最大值==

#### q1658前缀和 滑动窗口 总数
#### 方法一：滑动窗口
- ==思路：题目要求左右两边之和等于x，那么反过来求total-中间和=x，转换成滑动窗口即：total-窗口内元素之和=x==
- ==题解：==
  1. ==计算所有元素之和total，target=total-x==
  2. ==滑动窗口，当窗口元素之和等于target时，保存最小操作数：n-(right-left+1)==
  3. ==返回最小操作数==

#### 方法二：前缀和（低效，仅做学习）
- ==思想：【同滑动窗口】==
  - ==滑动窗口是取【中间区间】以推导【左右区间】的目标结果==
  - ==前缀和也可以取【中间区间】推导【左右区间】，但前缀和可以直接取【左右区间】==
- 思想应用：
  - 取左右区间：以前缀和作为分割点i,j,total：
    - 左区间：i
    - 右区间：total-j
  - ==题目应用：左区间+右区间=x，即i+(total-j)=x==
  - 实际操作：由于j在后，j即为当前遍历的前缀和，为已知，所以可转换为：
    - ==preSum[i]=x-(total-preSum[j])==
- ==题解：==
  1. 边界情况，当元素之和等于x时，直接返回n
  1. ==初始化前缀和容器Map<前缀和，下标>==
    - ==初始化边界情况，只需减去一边即可，即map[0]=0==
  2. ==计算元素和total==
  3. ==匹配前缀和满足preSum[i]=x-(total-preSum[j])的情况==
    - 满足保存左右边界的元素之和
- 重点：total-(sum[i]-sum[j])=x
  1. 元素>=1。即表示sum_j>0，则left存在操作，j+1(j为索引从0开始算需+1)；如sum_j=0则表示左边没有操作数j
  2. 左操作数区间和+有操作数区间和=x，即sum[j]+[total-(sum[i]-sum[j])-sum[j]]=x ，即sum[j]=sum[i]-total+x
  3. 作数数量：左=j+1或j，右=length-(i+1)。操作数量=左+右，注：当sum[j]=0则不存在操作数
- 方案：total-窗口内元素之和=x
  1. 初始化前缀和容器preSum、总数、结果
    - preSum[0,0]
    - 存在不减左边元素操作，即sum[i]需要sum[j]为0的情况
  2. 前缀和查找满足条件最小操作数
  3. 当sum[i]==x则所有减去所右元素才满足条件，res=nums.length

#### q1234 滑动窗口
- 思路：
  1. ==关注多余平均数的字符==
    - 如Q:1 W:4 E:3 R:4 length/4=3，关注W和R，满足条件最小替换即"WR"替换成"QQ"，长度为2。又或者WQR，长度为3
  2. ==滑动窗口，将整段字符串换掉使得达到平衡，保存需要换的最小长度==
- 题解：
  1. ==初始化窗口指针、结果res、s各个字符数量容器count[]==
  2. ==统计字符数量于count==
  3. ==滑动窗口。以减的形式==
    - 即滑动窗口right++时，是减少count中right位置字符的数量
  4. ==当'Q','W','E','R'都<length/4时，且left<length时，说明满足条件==
    - ==保存需要替换的长度，取最小值==
    - ==缩小窗口==
  5. 返回结果res
